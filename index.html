<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MindMates — AI персонажи</title>
  <style>
    :root{
      --bg:#0f1113; --card1:#161618; --accent:#ff4d6d; --muted:#9aa0a6;
      --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: "Segoe UI", Roboto, Arial, sans-serif;
      background:linear-gradient(180deg,#070708 0%, #0f1113 100%);
      color:#e6eef2; -webkit-font-smoothing:antialiased;
      min-height:100vh; display:flex; flex-direction:column; align-items:center;
    }

    header{width:100%; padding:28px 18px; display:flex; justify-content:center; align-items:center}
    .wrap{width:100%; max-width:1100px;}
    .brand{display:flex; gap:12px; align-items:center; font-weight:700}
    .brand .logo{width:44px; height:44px; display:flex; align-items:center; justify-content:center; border-radius:10px; background:linear-gradient(135deg,#ff7a97,#ff4d6d); color:#fff; font-size:20px}

    .hero{display:flex; gap:24px; align-items:center; justify-content:space-between; margin-bottom:18px}
    .hero .left h1{font-size:28px; margin:0 0 8px} 
    .hero .left p{margin:0; color:var(--muted)}
    .search{margin-top:12px; display:flex; gap:8px}
    .search input{background:var(--glass); border:1px solid rgba(255,255,255,0.03); color:#fff; padding:10px 12px; border-radius:10px; width:320px}
    .search button{background:var(--accent); border:none; color:#fff; padding:10px 14px; border-radius:10px; cursor:pointer}

    .characters{display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:18px; padding:18px 0 48px; width:100%}
    .character-card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:14px; padding:18px; text-align:center; box-shadow:0 6px 20px rgba(0,0,0,0.6); transition:transform .18s ease}
    .character-card:hover{transform:translateY(-6px)}
    .character-card img{width:100px;height:100px;border-radius:50%;object-fit:cover;border:3px solid rgba(255,255,255,0.04)}
    .character-card h3{margin:12px 0 6px}
    .character-card p{color:var(--muted); font-size:0.95rem; min-height:48px}
    .chat-btn{display:inline-block;margin-top:10px;padding:10px 16px;border-radius:999px;background:var(--accent); color:#fff;text-decoration:none;font-weight:600;cursor:pointer;border:none}

    footer{width:100%; padding:18px; color:var(--muted); text-align:center; border-top:1px solid rgba(255,255,255,0.02); margin-top:auto}

    /* Chat modal */
    .chat-overlay{position:fixed; inset:0; display:none; align-items:flex-end; justify-content:center; background:linear-gradient(180deg, rgba(0,0,0,0.4), rgba(0,0,0,0.6)); padding:18px; z-index:50}
    .chat-panel{width:100%; max-width:720px; background:#0b0b0c; border-radius:12px; overflow:hidden; display:flex; flex-direction:column; max-height:90vh}
    .chat-header{display:flex; gap:12px; align-items:center; padding:12px 14px; border-bottom:1px solid rgba(255,255,255,0.02)}
    .chat-header img{width:44px;height:44px;border-radius:8px;object-fit:cover}
    .chat-body{padding:12px; overflow:auto; flex:1; display:flex; flex-direction:column; gap:10px}
    .msg{max-width:78%; padding:10px 12px; border-radius:12px; line-height:1.3}
    .msg.user{align-self:flex-end; background:linear-gradient(90deg,#2b2b2d,#222); color:#fff}
    .msg.bot{align-self:flex-start; background:linear-gradient(90deg,#112,#08111a); color:#e6eef2}
    .chat-footer{display:flex; gap:8px; padding:10px; border-top:1px solid rgba(255,255,255,0.02)}

    @media (max-width:640px){
      .hero{flex-direction:column; align-items:flex-start}
      .search input{width:100%}
      .chat-overlay{align-items:flex-end}
    }
  </style>
</head>
<body>
  <header class="wrap">
    <div style="display:flex; justify-content:space-between; align-items:center;">
      <div class="brand"><div class="logo">MM</div><div>MindMates</div></div>
      <div style="color:var(--muted)">Demo • © 2025</div>
    </div>
  </header>

  <main class="wrap" style="padding-bottom:20px; width:100%;">
    <section class="hero">
      <div class="left">
        <h1>Говорите с AI‑персонажами мгновенно</h1>
        <p>Выберите персонажа и начните диалог — демонстрация без настройки.</p>
        <div class="search">
          <input id="q" placeholder="Поиск персонажей...">
          <button id="btnSearch">Найти</button>
        </div>
      </div>
      <div class="right" style="text-align:right; color:var(--muted)"></div>
    </section>

    <section id="characters" class="characters" aria-live="polite"></section>
  </main>

  <footer>
    © 2025 MindMates — Demo. Сайт локальный.
  </footer>

  <!-- Chat overlay -->
  <div id="chatOverlay" class="chat-overlay" role="dialog" aria-hidden="true">
    <div class="chat-panel" role="document">
      <div class="chat-header">
        <img id="chatAvatar" src="" alt="">
        <div>
          <div id="chatName" style="font-weight:700"></div>
          <div id="chatDesc" style="font-size:0.85rem;color:var(--muted)"></div>
        </div>
        <div style="margin-left:auto">
          <button id="closeChat" style="background:transparent;border:none;color:var(--muted);cursor:pointer">✕</button>
        </div>
      </div>
      <div id="chatBody" class="chat-body"></div>
      <div class="chat-footer">
        <input id="chatInput" placeholder="Напишите сообщение..." />
        <button id="chatSend">Отправить</button>
      </div>
    </div>
  </div>

  <script>
    // Загрузка персонажей
    async function loadCharacters(q=''){
      try{
        const res = await fetch('characters.json');
        const list = await res.json();
        const container = document.getElementById('characters');
        container.innerHTML = '';
        const filtered = list.filter(c => (c.name + ' ' + c.description).toLowerCase().includes(q.toLowerCase()));
        filtered.forEach(c => {
          const card = document.createElement('div');
          card.className = 'character-card';
          card.innerHTML = `
            <img src="${c.avatar}" alt="${c.name}">
            <h3>${c.name}</h3>
            <p>${c.description}</p>
            <div>
              <button class="chat-btn" data-id="${c.id}">Chat</button>
            </div>
          `;
          container.appendChild(card);
        });
      }catch(e){
        console.error(e);
        document.getElementById('characters').innerHTML = '<div style="color:#f66">Не удалось загрузить characters.json</div>';
      }
    }

    // Поиск
    document.getElementById('btnSearch').addEventListener('click', ()=> loadCharacters(document.getElementById('q').value));
    document.getElementById('q').addEventListener('keyup', (e)=>{ if(e.key==='Enter') loadCharacters(e.target.value); });

    // Chat logic (локальный mock)
    let characters = [];
    async function init(){
      const res = await fetch('characters.json');
      characters = await res.json();
      await loadCharacters();
    }

    function openChat(id){
      const ch = characters.find(x=>x.id===id);
      if(!ch) return;
      document.getElementById('chatOverlay').style.display = 'flex';
      document.getElementById('chatOverlay').setAttribute('aria-hidden','false');
      document.getElementById('chatAvatar').src = ch.avatar;
      document.getElementById('chatName').textContent = ch.name;
      document.getElementById('chatDesc').textContent = ch.description;
      const body = document.getElementById('chatBody');
      body.innerHTML = '';
      appendBot(`Привет! Я ${ch.name}. Чем могу помочь?`);
      document.getElementById('chatInput').focus();
    }

    function closeChat(){
      document.getElementById('chatOverlay').style.display = 'none';
      document.getElementById('chatOverlay').setAttribute('aria-hidden','true');
    }

    function appendUser(text){
      const d = document.createElement('div'); d.className='msg user'; d.textContent = text;
      document.getElementById('chatBody').appendChild(d); scrollChat();
    }
    function appendBot(text){
      const d = document.createElement('div'); d.className='msg bot'; d.textContent = text;
      document.getElementById('chatBody').appendChild(d); scrollChat();
    }
    function scrollChat(){ const b=document.getElementById('chatBody'); b.scrollTop = b.scrollHeight; }

    document.addEventListener('click', (e)=>{
      if(e.target.matches('.chat-btn')) openChat(e.target.dataset.id);
    });
    document.getElementById('closeChat').addEventListener('click', closeChat);
    document.getElementById('chatSend').addEventListener('click', ()=>{
      const v = document.getElementById('chatInput').value.trim();
      if(!v) return;
      appendUser(v);
      document.getElementById('chatInput').value = '';
      // mock AI reply
      setTimeout(()=> appendBot('Ответ от персонажа: ' + (Math.random() > 0.5 ? 'Я бы сделал так.' : 'Интересно, расскажите подробнее.')), 700);
    });
    document.getElementById('chatInput').addEventListener('keydown', (e)=>{ if(e.key==='Enter') document.getElementById('chatSend').click(); });

    // Инициализация
    init();
  </script>
</body>
</html>
